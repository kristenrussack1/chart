
<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notion API Test</title>
  <link rel="stylesheet" href="style.css" />
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['gantt']});
    google.charts.setOnLoadCallback(drawChart);

    function daysToMilliseconds(days) {
      return days * 24 * 60 * 60 * 1000;
    }

    async function getDataFromBackend() {
      const rest = await fetch("http://localhost:8007/users");
      const data = await rest.json();
      return data;
    }

    async function drawChart() {
      const dataFromBackend = await getDataFromBackend(); // Fetch data from backend
      const data = new google.visualization.DataTable();
      data.addColumn('string', 'Task ID');
      data.addColumn('string', 'Task Name');
      data.addColumn('date', 'Start Date');
      data.addColumn('date', 'End Date');
      data.addColumn('number', 'Duration');
      data.addColumn('number', 'Percent Complete');
      data.addColumn('string', 'Dependencies');

      // Add rows using data from the backend
      dataFromBackend.forEach((value, index) => {
        const endDate = value.endDate ? new Date(value.endDate) : new Date(value.startDate);
        data.addRows([
          [index.toString(), value.projectName, new Date(value.startDate), endDate, null, 0, value.subItemNames]
        ]);
      });


      var options = {
        height: 1200
      };

      var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
      chart.draw(data, options);
    }
  </script>
</head>
<body>
  <h1>Project Data</h1>
  <div id="chart_div"></div>
  <div id="container"></div>

  <script>
    async function addData() {
      const data = await getDataFromBackend();
      const container = document.getElementById("container");

      data.forEach((value) => {
        const div = document.createElement("div");
        div.classList.add("userContainer");
        div.innerHTML = `
          <h3>${value.projectName}</h3>
          <p><strong>Start Date:</strong> ${value.startDate}</p>
          <p><strong>End Date:</strong> ${value.endDate || "N/A"}</p>
          <p><strong>Parent Item:</strong> ${value.parentItem || "N/A"}</p>
          <p><strong>Sub-items:</strong> ${value.subItemNames.join(', ') || "N/A"}</p>
        `;

        container.appendChild(div);
      });
    }

    addData();
  </script>
</body>
</html> -->
<!-- 

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notion API Test</title>
  <link rel="stylesheet" href="style.css" />
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['gantt']});
    google.charts.setOnLoadCallback(drawChart);

    function daysToMilliseconds(days) {
      return days * 24 * 60 * 60 * 1000;
    }

    async function getDataFromBackend() {
      const rest = await fetch("http://localhost:8008/users");
      const data = await rest.json();
      return data;
    }

    async function drawChart() {
      const dataFromBackend = await getDataFromBackend(); // Fetch data from backend
      const data = new google.visualization.DataTable();
      data.addColumn('string', 'Task ID');
      data.addColumn('string', 'Task Name');
      data.addColumn('date', 'Start Date');
      data.addColumn('date', 'End Date');
      data.addColumn('number', 'Duration');
      data.addColumn('number', 'Percent Complete');
      data.addColumn('string', 'Dependencies');

      // Add rows using data from the backend
      dataFromBackend.forEach((value, index) => {
        const endDate = value.endDate ? new Date(value.endDate) : new Date(value.startDate);
        const dependencies = value.subItemIds.join(', '); // Join subitem IDs as dependencies
        data.addRows([
          [index.toString(), value.projectName, new Date(value.startDate), endDate, null, 0, dependencies]
        ]);
      });

      var options = {
        height: 1200
      };

      var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
      chart.draw(data, options);
    }
  </script>
</head>
<body>
  <h1>Project Data</h1>
  <div id="chart_div"></div>
  <div id="container"></div>

  <script>
    async function addData() {
      const data = await getDataFromBackend();
      const container = document.getElementById("container");

      data.forEach((value) => {
        const div = document.createElement("div");
        div.classList.add("userContainer");
        div.innerHTML = `
          <h3>${value.projectName}</h3>
          <p><strong>Start Date:</strong> ${value.startDate}</p>
          <p><strong>End Date:</strong> ${value.endDate || "N/A"}</p>
          <p><strong>Parent Item:</strong> ${value.parentItem || "N/A"}</p>
          <p><strong>Sub-items:</strong> ${value.subItemNames.join(', ') || "N/A"}</p>
        `;

        container.appendChild(div);
      });
    }

    addData();
  </script>
</body>
</html> -->





<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notion API Test 123</title>
  <link rel="stylesheet" href="style.css" />
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['gantt']});
    google.charts.setOnLoadCallback(drawChart);

    function daysToMilliseconds(days) {
      return days * 24 * 60 * 60 * 1000;
    }

    async function getDataFromBackend() {
      const rest = await fetch("http://localhost:8008/users");
      const data = await rest.json();
      return data;
    }

//     async function drawChart() {
//   const dataFromBackend = await getDataFromBackend(); // Fetch data from backend
//   const data = new google.visualization.DataTable();
//   data.addColumn('string', 'Task ID');
//   data.addColumn('string', 'Task Name');
//   data.addColumn('date', 'Start Date');
//   data.addColumn('date', 'End Date');
//   data.addColumn('number', 'Duration');
//   data.addColumn('number', 'Percent Complete');
//   data.addColumn('string', 'Parent Item');

//   dataFromBackend.forEach((value, index) => {
//     const endDate = value.endDate ? new Date(value.endDate) : new Date(value.startDate);
//     const parentItem = value.parentItem;
//     const projectName = value.projectName;
//     const ugh = value.ugh; // Assuming ugh is a field in dataFromBackend
//     let rowAdded = false;

//     if (parentItem === "Parent Item Names Not Available" && !rowAdded) {
//       data.addRows([
//         [index.toString(), projectName, new Date(value.startDate), endDate, 0, value.progress, null]
//       ]);
//       rowAdded = true;
//     } 
//     // if(value.subItemNames === projectName) {
//     //   data.addRows([
//     //     [index.toString(), projectName, new Date(value.startDate), endDate, 0, value.progress, null]
//     //   ]);
//     // }

//     // Check if subItemNames match projectName
//     // if (value.subItemNames === projectName) {
//     //   data.addRows([
//     //     [index.toString(), projectName, new Date(value.startDate), endDate, 0, value.progress, null]
//     //   ]);
//     // }
//   });

//   var options = {
//     height: 1200
//   };

//   var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
//   chart.draw(data, options);
// }




    // async function drawChart() {
    //   const dataFromBackend = await getDataFromBackend(); // Fetch data from backend
    //   const data = new google.visualization.DataTable();
    //   data.addColumn('string', 'Task ID');
    //   data.addColumn('string', 'Task Name');
    //   data.addColumn('date', 'Start Date');
    //   data.addColumn('date', 'End Date');
    //   data.addColumn('number', 'Duration');
    //   data.addColumn('number', 'Percent Complete'); // find my own average based on the sub(ids) end date
    //   data.addColumn('string', 'Sub-items');

    //   dataFromBackend.forEach((value, index) => {
    //     const endDate = value.endDate ? new Date(value.endDate) : new Date(value.startDate);
    //     const projectName = value.projectName;
    //     // let rowAdded = false;


    //     if (value.parentItem === "Parent Item Names Not Available") {
    //       data.addRows([
    //         [index.toString(), projectName, new Date(value.startDate), endDate, 0, value.progress, null]
    //       ]);
    //       // rowAdded = true;

    //   //     dataFromBackend.forEach((item, idx) => {
    //   //       const hi = item.subItemNames;
    //   //   if (hi === projectName && idx !== index) {
    //   //     data.addRows([
    //   //       [idx.toString(), item.projectName, new Date(item.startDate), new Date(item.endDate), 0, item.progress, null]
    //   //     ]);
    //   //   }
    //   // });

    //     }

    //     else { 
    //       data.addRows([
    //         [idx.toString(), item.projectName, new Date(item.startDate), new Date(item.endDate), 0, item.progress, null]
    //       ]);
    //     }
          
    //     }
    //   );

    //   var options = {
    //     height: 1200
    //   };

    //   var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
    //   chart.draw(data, options);
    // };








    async function drawChart() {
      const dataFromBackend = await getDataFromBackend(); // Fetch data from backend
      const data = new google.visualization.DataTable();
      data.addColumn('string', 'Task ID');
      data.addColumn('string', 'Task Name');
      data.addColumn('date', 'Start Date');
      data.addColumn('date', 'End Date');
      data.addColumn('number', 'Duration');
      data.addColumn('number', 'Percent Complete'); // find my own average based on the sub(ids) end date
      data.addColumn('string', 'Sub-items');

      dataFromBackend.forEach((value, index) => {
        const endDate = value.endDate ? new Date(value.endDate) : new Date(value.startDate);
        const projectName = value.projectName;


        if (value.subItemNames === "Sub-Item Names Not Available") {
          data.addRows([
            [index.toString(), projectName, new Date(value.startDate), endDate, 0, value.progress, value.parentItem]
          ]);

        }
        else{ 
          data.addRows([
            [index.toString(), projectName, new Date(value.startDate), endDate, 0, value.progress, null]
          ]);
        }
          
        }
      );

//     async function drawChart() {
//   const trees = await getDataFromBackend(); // Fetch data from backend
//   const data = new google.visualization.DataTable();
//   data.addColumn('string', 'Task ID');
//   data.addColumn('string', 'Task Name');
//   data.addColumn('date', 'Start Date');
//   data.addColumn('date', 'End Date');
//   data.addColumn('number', 'Duration');
//   data.addColumn('number', 'Percent Complete');
//   data.addColumn('string', 'Dependencies'); // Changed from 'Sub-items' to 'Dependencies'

//   function addNodeToChart(node) {
//     const endDate = node.endDate ? new Date(node.endDate) : new Date(node.startDate);
//     if (!node) return;
//     data.addRow([
//       node.project.id,
//       node.project.projectName,
//       new Date(node.project.startDate),
//       endDate, // Use calculated endDate here
//       null,
//       0,
//     null]);
//     node.children.forEach(addNodeToChart); // Recursively add children
//   }

//   trees.forEach(addNodeToChart);

  var options = {
    height: 1200
  };

//   // var table = new google.visualization.Table(document.getElementById('chart_div'));
//   // table.draw(data, options);


  var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
  chart.draw(data, options);
};




//     async function drawChart() {
//   const trees = await getDataFromBackend(); // Fetch multiple trees from backend

//   trees.forEach((tree) => {
//     const data = new google.visualization.DataTable();
//     data.addColumn('string', 'Task ID');
//     data.addColumn('string', 'Task Name');
//     data.addColumn('date', 'Start Date');
//     data.addColumn('date', 'End Date');
//     data.addColumn('number', 'Duration');
//     data.addColumn('number', 'Percent Complete');
//     data.addColumn('string', 'Parent Task ID');

//     const addNodeToChart = (node) => {
//       if (!node) return;
//       data.addRow([
//         node.project.id,
//         node.project.projectName,
//         new Date(node.project.startDate),
//         new Date(node.project.endDate),
//         null,
//         node.project.progress,
//         node.project.parentItemId,
//       ]);
//       node.children.forEach(addNodeToChart);
//     };

//     addNodeToChart(tree);

//     const chart = new google.visualization.Gantt(document.getElementById('chart_div_' + tree.project.id));
//     chart.draw(data);
//   });
// }

// Assuming you have multiple div elements with ids corresponding to each tree's root project id









  </script>
</head>
<body>
  <h1>Project Data</h1>
  <div id="chart_div"></div>
  <div id="container"></div>

  <script>
    async function addData() {
      const data = await getDataFromBackend();
      const container = document.getElementById("container");

      data.forEach((value) => {
        const div = document.createElement("div");
        div.classList.add("userContainer");
        div.innerHTML = `
          <h3>${value.projectName}</h3>
          <p><strong>Start Date:</strong> ${value.startDate}</p>
          <p><strong>End Date:</strong> ${value.endDate || "N/A"}</p>
          <p><strong>Parent Item:</strong> ${value.parentItem || "N/A"}</p>
          <p><strong>Sub-items:</strong> ${value.subItemNames.join(', ') || "N/A"}</p>
          <p><strong>progress:</strong> ${value.rollupProgress|| "0"}</p>
          <p><strong>subItemIds</strong> ${value.subItemIds|| "0"}</p>
          <p><strong>number:</strong> ${value.ugh|| "0"}</p>

        `;

        container.appendChild(div);
      });
    }

    addData();

    // async function addData(projectTrees) {
    //   const container = document.getElementById("container");

    //   projectTrees.forEach((tree) => {
    //     const div = document.createElement("div");
    //     div.classList.add("userContainer");
    //     div.innerHTML = `
    //       <h3>${tree.project.projectName}</h3>
    //       <p><strong>Start Date:</strong> ${tree.project.startDate}</p>
    //       <p><strong>End Date:</strong> ${tree.project.endDate || "N/A"}</p>
    //       <p><strong>Progress:</strong> ${tree.calculateAverageProgress()}</p>
    //     `;

    //     container.appendChild(div);
    //   });
    // }

    // // Assume projectTrees array is available from the backend or main function
    // const projectTrees = await getDataFromBackend();

    // addData(projectTrees);
  </script>
</body>
</html> 